2026-01-22 20:27:04.714 | INFO     | src.auth:__init__:47 - Using API key authentication (recommended)
2026-01-22 20:27:04.714 | INFO     | src.cache:__init__:76 - Cache initialized (enabled=True, max_size=1000)
2026-01-22 20:27:04.721 | INFO     | src.kledo_client:_load_endpoints_config:54 - Loaded 13 endpoint categories
2026-01-22 20:27:04.721 | INFO     | src.kledo_client:__init__:40 - Kledo API client initialized
2026-01-22 20:27:06.978 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices
2026-01-22 20:27:08.781 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices
2026-01-22 20:27:10.514 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices
2026-01-22 20:27:12.367 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices
2026-01-22 20:27:14.117 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices
2026-01-22 20:27:15.689 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/purchaseInvoices
2026-01-22 20:27:17.266 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/purchaseInvoices
2026-01-22 20:27:18.836 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/purchaseInvoices
2026-01-22 20:27:20.442 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/purchaseInvoices
2026-01-22 20:27:21.979 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/purchaseInvoices
2026-01-22 20:27:23.342 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/contacts
2026-01-22 20:27:24.686 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/contacts
2026-01-22 20:27:26.057 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/contacts
2026-01-22 20:27:27.601 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices/13335
2026-01-22 20:27:29.849 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices/13353
2026-01-22 20:27:31.459 | DEBUG    | src.kledo_client:_request:158 - Cached response for /finance/invoices/11776
Fetching sales invoices (multiple pages for diversity)...
Fetching purchase invoices...
Fetching contacts...
================================================================================
KLEDO API - DEEP STATUS & TYPE ID ANALYSIS
Generated: 2026-01-22 20:27:04
================================================================================

Objective: Map all status_id and type_id values from actual API data
Method: Query API extensively and analyze real responses

âœ“ Authentication successful

================================================================================
PART 1: SALES INVOICES - STATUS_ID MAPPING
================================================================================

Total invoices fetched: 500

Status ID Distribution:
--------------------------------------------------------------------------------

ðŸ“Š STATUS_ID = 1
   Count: 11 invoices
   Sample invoices:

   Sample 1:
     - Invoice #: INV/26/JAN/01158
     - Date: 2026-01-15
     - Amount: Rp 2,797,200
     - Due: Rp 2,797,200
     - Paid Date: None
     - Payment Date: None
     - Paid: 0.0%

   Sample 2:
     - Invoice #: INV/26/JAN/01148
     - Date: 2026-01-12
     - Amount: Rp 4,828,500
     - Due: Rp 4,828,500
     - Paid Date: None
     - Payment Date: None
     - Paid: 0.0%

   Sample 3:
     - Invoice #: INV/26/JAN/01138
     - Date: 2026-01-07
     - Amount: Rp 14,430,000
     - Due: Rp 14,430,000
     - Paid Date: None
     - Payment Date: None
     - Paid: 0.0%

   ðŸ’¡ Analysis:
      â†’ Likely UNPAID/PENDING (due = total amount)
      Average due: Rp 27,728,035
      Average total: Rp 27,728,035
      0% have paid_date

ðŸ“Š STATUS_ID = 2
   Count: 19 invoices
   Sample invoices:

   Sample 1:
     - Invoice #: INV/25/NOV/00983
     - Date: 2025-11-21
     - Amount: Rp 28,083,000
     - Due: Rp 2,900
     - Paid Date: None
     - Payment Date: 2025-11-21
     - Paid: 100.0%

   Sample 2:
     - Invoice #: INV/25/NOV/00955
     - Date: 2025-11-18
     - Amount: Rp 8,424,900
     - Due: Rp 900
     - Paid Date: None
     - Payment Date: 2025-11-18
     - Paid: 100.0%

   Sample 3:
     - Invoice #: INV/25/NOV/00955
     - Date: 2025-11-18
     - Amount: Rp 8,424,900
     - Due: Rp 900
     - Paid Date: None
     - Payment Date: 2025-11-18
     - Paid: 100.0%

   ðŸ’¡ Analysis:
      â†’ Unknown pattern
      Average due: Rp 8,282,350
      Average total: Rp 37,519,846
      0% have paid_date

ðŸ“Š STATUS_ID = 3
   Count: 470 invoices
   Sample invoices:

   Sample 1:
     - Invoice #: INV/26/JAN/01153
     - Date: 2026-01-19
     - Amount: Rp 4,410,000
     - Due: Rp 0
     - Paid Date: 2026-01-19
     - Payment Date: 2026-01-19
     - Paid: 100.0%

   Sample 2:
     - Invoice #: INV/26/JAN/01152
     - Date: 2026-01-19
     - Amount: Rp 8,391,600
     - Due: Rp 0
     - Paid Date: 2026-01-19
     - Payment Date: 2026-01-19
     - Paid: 100.0%

   Sample 3:
     - Invoice #: INV/26/JAN/01151
     - Date: 2026-01-15
     - Amount: Rp 6,915,300
     - Due: Rp 0
     - Paid Date: 2026-01-15
     - Payment Date: 2026-01-15
     - Paid: 100.0%

   ðŸ’¡ Analysis:
      â†’ Likely PAID (due=0, most have paid_date)
      Average due: Rp 0
      Average total: Rp 14,622,367
      100% have paid_date


================================================================================
PART 2: PURCHASE INVOICES - STATUS_ID MAPPING
================================================================================

Total purchase invoices fetched: 500

Status ID Distribution:
--------------------------------------------------------------------------------

ðŸ“Š STATUS_ID = 1
   Count: 142 bills
   Sample bills:

   Sample 1:
     - Bill #: PI/26/JAN/01174
     - Date: 2026-01-21
     - Amount: Rp 4,225,936
     - Due: Rp 4,225,936
     - Paid Date: None

   Sample 2:
     - Bill #: PI/26/JAN/01173
     - Date: 2026-01-21
     - Amount: Rp 2,442,000
     - Due: Rp 2,442,000
     - Paid Date: None

   Sample 3:
     - Bill #: PI/26/JAN/01172
     - Date: 2026-01-21
     - Amount: Rp 4,162,500
     - Due: Rp 4,162,500
     - Paid Date: None

ðŸ“Š STATUS_ID = 3
   Count: 358 bills
   Sample bills:

   Sample 1:
     - Bill #: PI/26/JAN/01136
     - Date: 2026-01-13
     - Amount: Rp 2,454,814
     - Due: Rp 0
     - Paid Date: 2026-01-13

   Sample 2:
     - Bill #: PI/25/DES/01100
     - Date: 2025-12-16
     - Amount: Rp 34,542,090
     - Due: Rp 0
     - Paid Date: 2026-01-12

   Sample 3:
     - Bill #: PI/25/DES/01078
     - Date: 2025-12-11
     - Amount: Rp 49,525,200
     - Due: Rp 0
     - Paid Date: 2025-12-11


================================================================================
PART 3: CONTACTS - TYPE_ID MAPPING
================================================================================

Total contacts fetched: 300

Type ID Distribution:
--------------------------------------------------------------------------------

ðŸ“Š TYPE_ID = 1
   Count: 47 contacts
   1/47 have receivables (money owed to us)
   5/47 have payables (money we owe)
   Sample contacts:

   Sample 1:
     - Name: KLEDO
     - Company: None
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 2:
     - Name: Elmo
     - Company: PT. NIPSEA PAINT AND CHEMICALS
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 3:
     - Name: Fadhel Zarmen
     - Company: CV. SUMBER SINERGI INDONESIA
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

ðŸ“Š TYPE_ID = 2
   Count: 13 contacts
   4/13 have receivables (money owed to us)
   0/13 have payables (money we owe)
   Sample contacts:

   Sample 1:
     - Name: Yadi
     - Company: PT. CEPAT SERVICE STATION
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 2:
     - Name: Dodo
     - Company: PT. CEPAT SERVICE STATION
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 3:
     - Name: Achmad Marcel Zakaria
     - Company: PT. CEPAT SERVICE STATION
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

ðŸ“Š TYPE_ID = 3
   Count: 192 contacts
   7/192 have receivables (money owed to us)
   3/192 have payables (money we owe)
   Sample contacts:

   Sample 1:
     - Name: Samuel Hariandya
     - Company: PT. KARTIKA EKAYASA
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 2:
     - Name: NUNGKY HENDRIYANI
     - Company: PT SAMATOR INDO GAS TBK
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 3:
     - Name: Aldy Reyhanshah
     - Company: None
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

ðŸ“Š TYPE_ID = 4
   Count: 48 contacts
   0/48 have receivables (money owed to us)
   1/48 have payables (money we owe)
   Sample contacts:

   Sample 1:
     - Name: Teuku Muda Rabian Hussein
     - Company: PT. CEPAT SERVICE STATION
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 2:
     - Name: Dani Sulistiyawan
     - Company: None
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00

   Sample 3:
     - Name: Squarespace
     - Company: None
     - Type Name: None
     - Receivable: Rp 0.00
     - Payable: Rp 0.00


================================================================================
PART 4: REVENUE CALCULATION - BEFORE/AFTER TAX
================================================================================

Field Relationship Analysis:
--------------------------------------------------------------------------------

Formula verification: amount_after_tax = subtotal + total_tax

Invoice: INV/26/JAN/01153
  Subtotal (before tax): Rp 4,410,000
  Tax: Rp 0
  Amount After Tax: Rp 4,410,000
  Calculated (subtotal + tax): Rp 4,410,000
  âœ“ Matches: True

Invoice: INV/26/JAN/01152
  Subtotal (before tax): Rp 7,560,000
  Tax: Rp 831,600
  Amount After Tax: Rp 8,391,600
  Calculated (subtotal + tax): Rp 8,391,600
  âœ“ Matches: True

Invoice: INV/26/JAN/01151
  Subtotal (before tax): Rp 6,230,000
  Tax: Rp 685,300
  Amount After Tax: Rp 6,915,300
  Calculated (subtotal + tax): Rp 6,915,300
  âœ“ Matches: True

Invoice: INV/26/JAN/01158
  Subtotal (before tax): Rp 2,520,000
  Tax: Rp 277,200
  Amount After Tax: Rp 2,797,200
  Calculated (subtotal + tax): Rp 2,797,200
  âœ“ Matches: True

Invoice: INV/26/JAN/01150
  Subtotal (before tax): Rp 2,300,000
  Tax: Rp 253,000
  Amount After Tax: Rp 2,553,000
  Calculated (subtotal + tax): Rp 2,553,000
  âœ“ Matches: True

Invoice: INV/26/JAN/01149
  Subtotal (before tax): Rp 5,040,000
  Tax: Rp 554,400
  Amount After Tax: Rp 5,594,400
  Calculated (subtotal + tax): Rp 5,594,400
  âœ“ Matches: True

Invoice: INV/26/JAN/01143
  Subtotal (before tax): Rp 6,850,000
  Tax: Rp 753,500
  Amount After Tax: Rp 7,603,500
  Calculated (subtotal + tax): Rp 7,603,500
  âœ“ Matches: True

Invoice: INV/26/JAN/01142
  Subtotal (before tax): Rp 14,050,000
  Tax: Rp 1,545,500
  Amount After Tax: Rp 15,595,500
  Calculated (subtotal + tax): Rp 15,595,500
  âœ“ Matches: True

Invoice: INV/26/JAN/01148
  Subtotal (before tax): Rp 4,350,000
  Tax: Rp 478,500
  Amount After Tax: Rp 4,828,500
  Calculated (subtotal + tax): Rp 4,828,500
  âœ“ Matches: True

Invoice: INV/26/JAN/01141
  Subtotal (before tax): Rp 3,317,000
  Tax: Rp 364,870
  Amount After Tax: Rp 3,681,870
  Calculated (subtotal + tax): Rp 3,681,870
  âœ“ Matches: True

================================================================================
REVENUE CALCULATION RECOMMENDATION
================================================================================

Based on the field analysis:

1. FOR SALES REP COMMISSION (Before Tax):
   Use: invoices.subtotal
   Why: This represents the revenue before tax, suitable for commission calculation

2. FOR ACTUAL REVENUE (With Tax):
   Use: invoices.amount_after_tax
   Why: This is the total amount including tax, the actual revenue

3. FORMULA VERIFICATION:
   âœ“ Confirmed: amount_after_tax = subtotal + total_tax

4. BOTH OPTIONS SHOULD BE AVAILABLE:
   - revenue_before_tax = SUM(subtotal)
   - revenue_after_tax = SUM(amount_after_tax)
    


================================================================================
PART 5: INVOICE DETAIL INSPECTION (for additional status info)
================================================================================

Detailed Invoice Fields (checking for status_name or other status indicators):
--------------------------------------------------------------------------------


================================================================================
SUMMARY & NEXT STEPS
================================================================================

âœ“ Data Analysis Complete

FINDINGS:
1. Found multiple status_id values in sales invoices
2. Found multiple status_id values in purchase invoices
3. Mapped type_id values for contacts
4. Verified revenue calculation fields (before/after tax)

RECOMMENDATIONS:
1. Check the invoice numbers in your Kledo dashboard to confirm status meanings
2. Or check Kledo API documentation for official status mappings
3. Update the field mapping document with confirmed status meanings

STATUS_ID PATTERNS OBSERVED:
(See detailed analysis above for each status_id with sample data)

TYPE_ID PATTERNS OBSERVED:
(See detailed analysis above for each type_id with sample data)

REVENUE FIELDS CONFIRMED:
âœ“ subtotal = revenue before tax (for commission)
âœ“ amount_after_tax = revenue with tax (for actual revenue)
âœ“ total_tax = tax amount
    

âœ“ Analysis saved to: /Users/kevinzakaria/developers/kledo-api-mcp/tests/STATUS_ANALYSIS.md
âœ“ Raw data saved to: /Users/kevinzakaria/developers/kledo-api-mcp/tests/status_analysis_data.json
