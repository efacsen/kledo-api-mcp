---
phase: 04-smart-routing
plan: 03
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "rapidfuzz package is installed in Python environment"
    - "Routing module imports successfully without ModuleNotFoundError"
    - "route_query function is callable and returns RoutingResult"
  artifacts:
    - path: "pip show rapidfuzz"
      provides: "Installed package confirmation"
      contains: "Name: rapidfuzz"
  key_links:
    - from: "requirements.txt"
      to: "Python environment"
      via: "pip install"
      pattern: "Successfully installed rapidfuzz"
---

<objective>
Install missing rapidfuzz dependency to make the routing module functional.

Purpose: The routing module implementation is complete (1,122 lines across 7 modules) but cannot be imported because rapidfuzz was declared in requirements.txt but not installed. This blocks verification of phase completion.

Output: Working routing module that can be imported and tested.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04-smart-routing/04-VERIFICATION.md

Gap being closed:
- Truth #10: "Routing module is importable and functional" - FAILED
- Reason: rapidfuzz in requirements.txt but not pip installed
- Impact: Module import fails with ModuleNotFoundError
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and verify routing module</name>
  <files>None (environment setup only)</files>
  <action>
1. Install all requirements including rapidfuzz:
   pip install -r requirements.txt

2. Verify rapidfuzz is installed:
   pip show rapidfuzz

3. Verify routing module imports successfully:
   python -c "from src.routing import route_query, ToolSuggestion, RoutingResult; print('Import SUCCESS')"

4. Run a quick functional test to confirm routing works:
   python -c "
from src.routing import route_query
result = route_query('outstanding invoices')
print(f'Query: outstanding invoices')
print(f'Suggestions: {len(result.suggestions)} tools')
print(f'Top tool: {result.suggestions[0].tool_name if result.suggestions else \"None\"}')
"
  </action>
  <verify>
- `pip show rapidfuzz` shows version >= 3.14.0
- `python -c "from src.routing import route_query"` exits with code 0
- Functional test returns routing suggestions
  </verify>
  <done>
- rapidfuzz package installed
- Routing module imports without errors
- route_query returns valid RoutingResult with suggestions
  </done>
</task>

</tasks>

<verification>
After task completion, verify the gap is closed:

1. Module import test:
   python -c "from src.routing import route_query, normalize_term, SYNONYM_MAP, parse_natural_date, fuzzy_lookup, match_pattern, extract_keywords, score_tool"

2. Functional routing test:
   python -c "
from src.routing import route_query
# Test pattern matching
r1 = route_query('who owes me money')
assert len(r1.suggestions) > 0, 'Pattern match failed'
# Test synonym resolution
r2 = route_query('show revenue')
assert len(r2.suggestions) > 0, 'Synonym resolution failed'
# Test fuzzy matching
r3 = route_query('invoise list')
assert len(r3.suggestions) > 0, 'Fuzzy matching failed'
print('All routing tests PASSED')
"
</verification>

<success_criteria>
- [ ] rapidfuzz >= 3.14.0 installed (pip show confirms)
- [ ] All routing module exports importable (no ModuleNotFoundError)
- [ ] route_query returns RoutingResult with suggestions for test queries
- [ ] Gap #10 from VERIFICATION.md is resolved
</success_criteria>

<output>
After completion, create `.planning/phases/04-smart-routing/04-03-SUMMARY.md`
</output>
