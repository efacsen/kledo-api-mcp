---
phase: 02-documentation-layer
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - mkdocs.yml
  - requirements.txt
  - docs/index.md
  - docs/entities/index.md
  - docs/entities/contact.md
  - docs/entities/product.md
  - docs/entities/invoice.md
  - docs/entities/order.md
  - docs/entities/delivery.md
  - docs/entities/account.md
autonomous: true

must_haves:
  truths:
    - "Entity documentation pages render in MkDocs with Mermaid diagrams"
    - "Entity relationships are visualized in ERD format"
    - "Embedded types (InvoiceItem, OrderItem, etc.) documented on parent pages"
  artifacts:
    - path: "mkdocs.yml"
      provides: "MkDocs Material configuration"
      contains: "theme:"
    - path: "docs/entities/index.md"
      provides: "Entity overview with full ERD"
      contains: "```mermaid"
    - path: "docs/entities/invoice.md"
      provides: "Invoice entity with InvoiceItem embedded"
      contains: "InvoiceItem"
  key_links:
    - from: "mkdocs.yml"
      to: "docs/**/*.md"
      via: "nav configuration"
      pattern: "nav:"
    - from: "docs/entities/*.md"
      to: "src/entities/models/*.py"
      via: "schema references"
      pattern: "classDiagram"
---

<objective>
Set up MkDocs Material documentation site and create entity documentation with Mermaid ERD diagrams.

Purpose: Establish the documentation foundation and fulfill DOCS-02 (entity relationship documentation in Markdown).
Output: Working MkDocs site with entity pages, Mermaid diagrams, and Material theme configured.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-documentation-layer/02-CONTEXT.md
@.planning/phases/02-documentation-layer/02-RESEARCH.md

Source files:
@src/entities/loader.py
@src/entities/models/invoice.py
@src/entities/models/contact.py
@src/entities/models/product.py
@src/entities/models/order.py
@src/entities/models/delivery.py
@src/entities/models/account.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure MkDocs Material with dependencies</name>
  <files>mkdocs.yml, requirements.txt</files>
  <action>
1. Add MkDocs Material dependencies to requirements.txt:
   - mkdocs-material>=9.5.0
   - mkdocstrings[python]>=0.24.0
   - pydantic-2-mermaid>=0.8.0

2. Create mkdocs.yml with configuration from RESEARCH.md Pattern 2:
   - site_name: "Kledo MCP Server"
   - theme: material with navigation.tabs, navigation.sections, search, code.copy
   - palette: indigo primary with light/dark toggle
   - markdown_extensions: pymdownx.superfences with mermaid custom_fences, admonition, toc
   - plugins: search, mkdocstrings (python handler, google docstring style)
   - nav structure: Home, Entities (with 6 entity pages), Tools (placeholder for Plan 02)

3. Install dependencies: pip install -r requirements.txt

Note: Use native Material mermaid support (NOT mermaid2-plugin which has conflicts).
  </action>
  <verify>
    - mkdocs --version shows installed
    - mkdocs build --strict succeeds (may warn about missing pages)
  </verify>
  <done>MkDocs Material configured with Mermaid support, dependencies installed</done>
</task>

<task type="auto">
  <name>Task 2: Create entity documentation pages with Mermaid ERDs</name>
  <files>docs/index.md, docs/entities/index.md, docs/entities/contact.md, docs/entities/product.md, docs/entities/invoice.md, docs/entities/order.md, docs/entities/delivery.md, docs/entities/account.md</files>
  <action>
1. Create docs/index.md:
   - Title: "Kledo MCP Server Documentation"
   - Brief overview: MCP Server for Kledo accounting API
   - Links to Entities and Tools sections
   - Quick start: how to use with Claude Desktop

2. Create docs/entities/index.md:
   - Title: "Entity Registry"
   - Full ERD diagram showing all 6 entities and their relationships using Mermaid classDiagram
   - Brief description of entity registry from Phase 1
   - Links to individual entity pages

3. Create entity pages (contact.md, product.md, invoice.md, order.md, delivery.md, account.md):

   For each entity page:
   - Title: Entity name
   - Description: What this entity represents in Kledo
   - Mermaid diagram showing this entity's relationships (focused view)
   - Field table: name, type, description (extract from Pydantic model)
   - Embedded types section (if applicable):
     * InvoiceItem on invoice.md
     * OrderItem on order.md
     * DeliveryItem on delivery.md
     * Warehouse on product.md
   - Related Tools section: placeholder links to tool pages

   Use RESEARCH.md Pattern 1 (hybrid template + auto-generated) as guide.
   Extract field info from src/entities/models/*.py Pydantic definitions.

4. Generate Mermaid ERD content:

   Full ERD (for entities/index.md):
   ```mermaid
   classDiagram
       class Contact {
           +int id
           +str name
           +int type_id
           +str email
       }
       class Product {
           +int id
           +str name
           +str code
           +Decimal price
       }
       class Invoice {
           +int id
           +str trans_number
           +date trans_date
           +int contact_id
           +Decimal grand_total
       }
       class Order {
           +int id
           +str trans_number
           +int contact_id
       }
       class Delivery {
           +int id
           +str trans_number
           +int contact_id
       }
       class Account {
           +int id
           +str name
           +str number
           +int category_id
       }

       Invoice --> Contact : contact_id
       Invoice *-- InvoiceItem : detail
       Order --> Contact : contact_id
       Order *-- OrderItem : detail
       Delivery --> Contact : contact_id
       Delivery *-- DeliveryItem : detail
       InvoiceItem --> Product : product_id
       OrderItem --> Product : product_id
       DeliveryItem --> Product : product_id
       Product *-- Warehouse : warehouses
   ```

   Create focused diagrams for each entity page showing only that entity's relationships.
  </action>
  <verify>
    - mkdocs serve runs and serves docs at http://127.0.0.1:8000
    - Navigate to Entities section, see ERD diagram rendered
    - Each entity page shows focused relationship diagram
    - Embedded types (InvoiceItem, etc.) visible on parent pages
  </verify>
  <done>Entity documentation with Mermaid ERDs renders correctly in MkDocs, embedded types documented on parent entity pages</done>
</task>

</tasks>

<verification>
After all tasks:
1. `mkdocs build --strict` completes without errors
2. `mkdocs serve` serves documentation locally
3. Entity ERD visible on entities/index.md
4. All 6 entity pages accessible with field tables and relationship diagrams
5. Embedded types (InvoiceItem, OrderItem, DeliveryItem, Warehouse) on parent pages
</verification>

<success_criteria>
- MkDocs Material site builds and serves
- Entity relationship documentation complete (DOCS-02)
- Mermaid diagrams render in browser
- Navigation works between entity pages
</success_criteria>

<output>
After completion, create `.planning/phases/02-documentation-layer/02-01-SUMMARY.md`
</output>
